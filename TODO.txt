# TODO

- implement new AutoEQ class
  - handles lookup in AutoEQ
  - knows about precedences
  - has #to_equalizer that makes equalizers

- make most commands work on albums, not releases/etc.
  - use Discogs as original source of truth
  - but not for searching
  - except for unripped, etc.

- create better way of making sub-commands
  - as easy as shell script
  - no class or methods needed
  - one command -> one file
  - auto-loaded from commands/ directory
  - no need to modify bin/musicbox or lib/musicbox.rb
  - predefined variables:
    - $catalog (based on --root)
    - $prompt

- split up Catalog
  - Discogs-related classes under Discogs
  - Album, AlbumTrack, Artist (new) under Catalog

- re-implement file-based Group?
  - convert all Discogs structures

- make covers 2-up

- center cover horizontally on page

- make crop marks on covers

- only use #cd? to determine need for ripping
  - add default find selector to reject releases with non-rippable formats
      https://www.discogs.com/help/formatslist
  - can override to show full collection, find dups, or make LP/etc. labels

- rework use of #album != nil to has_album?

- fix 'dup' command to not treat multidisc release as duplicate

- import: handle multiple formats/discs better
  - consider case where digitized LP becomes album
  - if more than one format, prompt for choice
  - but how to handle multidisc releases 
    - some have formats of [CD, CD] ('expanded')
    - others have [CD x2] ('compact')
  - save selected format into album info
  - in general:
    - goal is to create list of tracks with minimal metadata:
      - track #
      - disc # (optional)
      - title
      - artist (optional)
      - (others inherited from album)
    - use Discogs data as a guide/template
      - but allow assigning, collapsing, expanding, reordering as needed

- allow creation of standalone album
  - for: unreleased, mixtape, etc.

- allow label font to be configured

- save artist ID into album

- consider using Album/AlbumTrack as master/truth?
  - keep in SQLite?
  - created/updated from Discogs, but treated separately

- keep separate list of artists
  - integrate key, first/last name order

- save @cover_file in album info.json file?
  - just read cover_file (as path) instead of deriving via glob

- reimplement player state checkpointing, to resume exactly where left off

- use curses or tty for full-screen player TTY mode?

- use TTY::ProgressBar to show track playing progress?

- move config handling into MusicBox class
  - also definition of import dir, etc.
  - use TTY::Config?

- sort #find results by relevance, not by artist/title

- move #find into Group
  - move hard-coded selectors into Group subclasses
    - call dynamically
    - eg, ':cd' => send("select_cd")

- improve 'select' tool
  - save to $MUSIC_ROOT/selection.json?
  - optionally name
  - can be referred to in query

- when updating collection, don't simply delete previous collection
  - determine additions/removals/changes
  - handle case where Discogs has merged/moved releases
    - ie, release_id has changed
    - need to move related album

- when finding unripped CDs, also look for dups
  - to avoid needing to rip dup CDs

- allow artist key to be user-defined
  - save in group database
  - allow for modification as needed
  - ensure uniqueness
  - allow override of primary artist
    - eg, to file release under main artist instead of artist-group of collaboration
  - do artist sort/rename using artist ID
    - instead of CanonicalArtists/PersonalNames hash maps

- use exiftool instead of ffprobe/mp4tags
  $ exiftool -json -recurse . -ext m4a

- improve log handling
  - create Log class with attributes:
    - timestamp
    - media type
    - accurip details
    - file:
    - disc: (can be nil)
    - status: (overall)
    - tracks status: (tracks)
  - add command to show:
    - missing rips (no tracks or log files)
    - questionable rips (tracks, but no log files)
    - unconfirmed rips (no record in online databases)
    - bad rips (actual read errors)
    - dubious rips (inconsistent checksums)
    - successful rips

- improve validation
  - validate logs
  - ensure cover exists
  - ensure track files exist

- calculate loudness
  - see: info/replay-gain.md